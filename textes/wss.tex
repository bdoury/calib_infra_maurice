% !TEX root = ../distCjHMSC.tex
%==============================================================
A multivariate time series $x_{n}$ is said to be a zero-mean wide-sense stationary (WSS) process of second order iif $\esp{x_{n}}=0$, $\trace{\esp{x_{n}x_{n}^{H}}}<+\infty$ and the sequence of covariance matrices\footnote{The superscript $H$ denotes the transposition-conjugaison, $T$ the transposition and $*$ the conjugaison.} $R(h)=\esp{x_{n+h}x_{n}^{H}}$ does not depend on $n$. 
It follows that $R(h)=R^{H}(-h)$. Therefore if $x_{n}$ is real $R(h)=R^{T}(-h)$.

Under very general conditions, its Fourier transform
$$
 \Gamma(f)=\sum_{h} R(h)e^{-2j\pi hf},\quad\text{with}\quad 
 f\in(0,1)
$$
exists which is called the spectral matrix sequence. A fundamental property says that 
$$
 \forall f, \quad \Gamma(f)\geq 0
$$
The non-negativity of $\Gamma(f)$ implies that $\Gamma_{ij}(f)=\Gamma_{ji}^{*}(f)$ and $\Gamma_{ii}(f)\geq 0$. If $x_{n}$ is real alors $\Gamma(f)=\Gamma(-f)$. For example for a bivariate process we have
$$
 \Gamma(f)=
 \begin{bmatrix}
 \Gamma_{11}(f)&\Gamma_{12}(f)\\
 \Gamma_{21}(f)&\Gamma_{22}(f)
 \end{bmatrix}
$$
where $ \Gamma_{11}(f)$ and $ \Gamma_{22}(f)$ are both positive functions. The coherence matrix is defined by
\begin{eqnarray*}
 C(f) 
 &=&
 \begin{bmatrix}
 \Gamma_{11}^{-1/2}(f)&0
 \\
 0& \Gamma_{22}^{-1/2}(f)
 \end{bmatrix}
  \begin{bmatrix}
 \Gamma_{11}(f)&\Gamma_{12}(f)\\ \Gamma_{21}(f)&\Gamma_{22}(f)
 \end{bmatrix}
 \begin{bmatrix}
 \Gamma_{11}^{-1/2}(f)&0
 \\
 0& \Gamma_{22}^{-1/2}(f)
 \end{bmatrix}
 \\
 &=&
   \begin{bmatrix}
 1&C_{12}(f)\\ C_{21}(f)&1
 \end{bmatrix}
\end{eqnarray*}
with $C_{12}(f)=C_{2,1}^{*}(f)$. Let
\begin{eqnarray}
\label{eq:defCSD}
 \eta_{12}(f)= \frac{\Gamma_{12}(f)}{\sqrt{\Gamma_{11}(f)\Gamma_{22}(f)}}
\end{eqnarray}
which is called the  normalized cross spectral density and
\begin{eqnarray}
\label{eq:defMSC}
 \MSC(f)= \frac{|\Gamma_{12}(f)|^{2}}{\Gamma_{11}(f)\Gamma_{22}(f)}
\end{eqnarray}
which is called the Magnitude Squared Coherence (MSC) or shortly the coherence. A fundamental property says that 
$$
 \forall f, \quad \MSC(f)\leq 1
$$
and the equality occurs iff it exists a filter s.t. one signal of the bivariate process is the filtering  of the other. In this case $\Gamma(f)$ is, up to a a multiplicative positive value, a projector of rank 1. A fundamental example is given by
$$
\begin{array}{ccc}
\left\{
 \begin{array}{rcl}
 x_{1,n}&=&g_{1,n}\star s_{n}
 \\
 x_{2,n}&=&g_{2,n}\star s_{n}
\end{array}
\right.
&\Leftrightarrow&
x_{n}=\begin{bmatrix}
x_{1,n}\\ x_{2,n} 
\end{bmatrix} = h_{n} \star s_{n}
\end{array}
$$
where $s_{n}$ is a monovariate WSS process with spectral density $\gamma_{s}(f)$. Then the spectral matrix of the bivariate process writes 
$$
 \Gamma(f)=\gamma_{s}(f)G(f)G^{H}(f)
$$
and
$$
C(f) 
= \begin{bmatrix}1&1\\1&1\end{bmatrix}
= \begin{bmatrix}1\\1\end{bmatrix}
  \begin{bmatrix}1&1\end{bmatrix}
$$
In the noisy case if the spectral matrix of the two noises is diagonal with respective spectral densities $\gamma_{1}(f)$ and  $\gamma_{2}(f)$, the spectral matrix writes:
$$
 \Gamma(f) = \gamma_{s}(f)
 \renewcommand\arraystretch{1.6}
 \begin{bmatrix}
| G_{1}(f)|^{2}& G_{1}(f)G_{2}^{*}(f)
 \\
 G_{1}^{*}(f)G_{2}(f)& | G_{2}(f)|^{2}
 \end{bmatrix}
 +
  \begin{bmatrix}
 \gamma_{1}(f)| G_{1}(f)|^{2}& 0
 \\
 0& \gamma_{2}(f)| G_{2}(f)|^{2}
 \end{bmatrix}
$$
then
\begin{eqnarray*}
 \MSC(f) 
 &=& 
 \frac{|\Gamma_{1,2}(f)|^{2}}{\Gamma_{1,1}(f)\Gamma_{2,2}(f)}
 \\
 &=&
 \frac{1}
   {(1+\mathrm{SNR}_{1}^{-1}(f))(1+\mathrm{SNR}_{2}^{-1}(f))}
\end{eqnarray*}
where
$$
 \mathrm{SNR}_{1}(f)=\frac{\gamma_{s}(f)}{\gamma_{1}(f)}
 \quad\text{and}\quad
 \mathrm{SNR}_{2}(f)=\frac{\gamma_{s}(f)}{\gamma_{2}(f)}
$$

All these expressions can be generalized for more than 2 dimensions.
